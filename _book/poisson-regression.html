<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Poisson Regression | Data Analysis in Medicine and Health using R</title>
  <meta name="description" content="Chapter 10 Poisson Regression | Data Analysis in Medicine and Health using R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Poisson Regression | Data Analysis in Medicine and Health using R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://bookdown.org/drki_musa/dataanalysis/" />
  
  
  <meta name="github-repo" content="drkamarul/multivar_data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Poisson Regression | Data Analysis in Medicine and Health using R" />
  
  
  

<meta name="author" content="Kamarul Imran, Wan Nor Arifin, Tengku Muhammad Hanis Tengku Mukhtar" />


<meta name="date" content="2022-01-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="binary-logistic-regression.html"/>
<link rel="next" href="survival-analysis.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis in Medicine and Health using R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html"><i class="fa fa-check"></i><b>1</b> Introduction to R, RStudio and RStudio Cloud</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#rstudio-cloud"><i class="fa fa-check"></i><b>1.1</b> RStudio Cloud</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#the-rstudio-cloud-registration"><i class="fa fa-check"></i><b>1.1.1</b> The RStudio Cloud Registration</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#register-and-log-in"><i class="fa fa-check"></i><b>1.1.2</b> Register and log in</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#point-and-click-r-gui"><i class="fa fa-check"></i><b>1.2</b> Point and click R GUI</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#rstudio-server"><i class="fa fa-check"></i><b>1.3</b> RStudio Server</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#installing-r-and-rstudio-on-your-local-machine"><i class="fa fa-check"></i><b>1.4</b> Installing R and RStudio on Your Local Machine</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#installing-r"><i class="fa fa-check"></i><b>1.4.1</b> Installing R</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#installing-rstudio-ide"><i class="fa fa-check"></i><b>1.4.2</b> Installing RStudio IDE</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#checking-r-and-rstudio-installations"><i class="fa fa-check"></i><b>1.4.3</b> Checking R and RStudio Installations</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#installation-of-miktex-texlive-and-mactex"><i class="fa fa-check"></i><b>1.4.4</b> Installation of MiKTeX, TeXLive and MacTex</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#starting-your-rstudio"><i class="fa fa-check"></i><b>1.5</b> Starting your RStudio</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#console-tab"><i class="fa fa-check"></i><b>1.5.1</b> Console tab</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#files-plots-packages-help-and-viewer-pane"><i class="fa fa-check"></i><b>1.5.2</b> Files, Plots, Packages, Help and Viewer Pane</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#environment-history-connection-and-build-pane"><i class="fa fa-check"></i><b>1.5.3</b> Environment, History, Connection and Build Pane</a></li>
<li class="chapter" data-level="1.5.4" data-path="introduction-to-r-rstudio-and-rstudio-cloud.html"><a href="introduction-to-r-rstudio-and-rstudio-cloud.html#source-pane"><i class="fa fa-check"></i><b>1.5.4</b> Source Pane</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html"><i class="fa fa-check"></i><b>2</b> R Scripts and R Packages</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#open-a-new-r-script"><i class="fa fa-check"></i><b>2.1</b> Open a new R script</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#our-first-r-script"><i class="fa fa-check"></i><b>2.1.1</b> Our first R script</a></li>
<li class="chapter" data-level="2.1.2" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#function-argument-and-parameters"><i class="fa fa-check"></i><b>2.1.2</b> Function, Argument and Parameters</a></li>
<li class="chapter" data-level="2.1.3" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#need-more-help"><i class="fa fa-check"></i><b>2.1.3</b> Need more help?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#packages"><i class="fa fa-check"></i><b>2.2</b> Packages</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#packages-on-cran"><i class="fa fa-check"></i><b>2.2.1</b> Packages on CRAN</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#check-if-the-package-you-need-is-available-in-your-r-library"><i class="fa fa-check"></i><b>2.2.2</b> Check if the package you need is available in your R library</a></li>
<li class="chapter" data-level="2.2.3" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#install-an-r-package"><i class="fa fa-check"></i><b>2.2.3</b> Install an R package</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#directory"><i class="fa fa-check"></i><b>2.3</b> Directory</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#starting-your-r-job"><i class="fa fa-check"></i><b>2.3.1</b> Starting your R job</a></li>
<li class="chapter" data-level="2.3.2" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#create-new-project"><i class="fa fa-check"></i><b>2.3.2</b> Create new project</a></li>
<li class="chapter" data-level="2.3.3" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#where-is-my-data"><i class="fa fa-check"></i><b>2.3.3</b> Where is my data?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#upload-data-to-rstudio-cloud"><i class="fa fa-check"></i><b>2.4</b> Upload data to RStudio Cloud</a></li>
<li class="chapter" data-level="2.5" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#more-resources-on-rstudio-cloud"><i class="fa fa-check"></i><b>2.5</b> More resources on RStudio Cloud</a></li>
<li class="chapter" data-level="2.6" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#need-help"><i class="fa fa-check"></i><b>2.6</b> Need help?</a></li>
<li class="chapter" data-level="2.7" data-path="r-scripts-and-r-packages.html"><a href="r-scripts-and-r-packages.html#bookdown"><i class="fa fa-check"></i><b>2.7</b> Bookdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rstudio-project.html"><a href="rstudio-project.html"><i class="fa fa-check"></i><b>3</b> RStudio Project</a>
<ul>
<li class="chapter" data-level="3.1" data-path="rstudio-project.html"><a href="rstudio-project.html#objectives"><i class="fa fa-check"></i><b>3.1</b> Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="rstudio-project.html"><a href="rstudio-project.html#dataset-repository-on-github"><i class="fa fa-check"></i><b>3.2</b> Dataset repository on GitHub</a></li>
<li class="chapter" data-level="3.3" data-path="rstudio-project.html"><a href="rstudio-project.html#rstudio-project-on-rstudio-cloud"><i class="fa fa-check"></i><b>3.3</b> RStudio project on RStudio Cloud</a></li>
<li class="chapter" data-level="3.4" data-path="rstudio-project.html"><a href="rstudio-project.html#rstudio-project-on-local-machine"><i class="fa fa-check"></i><b>3.4</b> RStudio project on local machine</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>4</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-visualization.html"><a href="data-visualization.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="data-visualization.html"><a href="data-visualization.html#history-and-objectives-of-data-visualization"><i class="fa fa-check"></i><b>4.2</b> History and objectives of Data Visualization</a></li>
<li class="chapter" data-level="4.3" data-path="data-visualization.html"><a href="data-visualization.html#ingredients-for-good-graphics"><i class="fa fa-check"></i><b>4.3</b> Ingredients for Good Graphics</a></li>
<li class="chapter" data-level="4.4" data-path="data-visualization.html"><a href="data-visualization.html#graphics-packages-in-r"><i class="fa fa-check"></i><b>4.4</b> Graphics Packages in R</a></li>
<li class="chapter" data-level="4.5" data-path="data-visualization.html"><a href="data-visualization.html#the-ggplot2-package"><i class="fa fa-check"></i><b>4.5</b> The <strong>ggplot2</strong> Package</a></li>
<li class="chapter" data-level="4.6" data-path="data-visualization.html"><a href="data-visualization.html#preparation"><i class="fa fa-check"></i><b>4.6</b> Preparation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-visualization.html"><a href="data-visualization.html#create-a-new-rstudio-project"><i class="fa fa-check"></i><b>4.6.1</b> Create a New RStudio Project</a></li>
<li class="chapter" data-level="4.6.2" data-path="data-visualization.html"><a href="data-visualization.html#important-questions-when-making-graphs"><i class="fa fa-check"></i><b>4.6.2</b> Important Questions when Making Graphs</a></li>
<li class="chapter" data-level="4.6.3" data-path="data-visualization.html"><a href="data-visualization.html#read-data"><i class="fa fa-check"></i><b>4.6.3</b> Read Data</a></li>
<li class="chapter" data-level="4.6.4" data-path="data-visualization.html"><a href="data-visualization.html#load-the-library"><i class="fa fa-check"></i><b>4.6.4</b> Load the Library</a></li>
<li class="chapter" data-level="4.6.5" data-path="data-visualization.html"><a href="data-visualization.html#read-dataset"><i class="fa fa-check"></i><b>4.6.5</b> Read Dataset</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-visualization.html"><a href="data-visualization.html#basic-plots"><i class="fa fa-check"></i><b>4.7</b> Basic Plots</a></li>
<li class="chapter" data-level="4.8" data-path="data-visualization.html"><a href="data-visualization.html#adding-another-variable"><i class="fa fa-check"></i><b>4.8</b> Adding another variable</a></li>
<li class="chapter" data-level="4.9" data-path="data-visualization.html"><a href="data-visualization.html#making-subplots"><i class="fa fa-check"></i><b>4.9</b> Making Subplots</a></li>
<li class="chapter" data-level="4.10" data-path="data-visualization.html"><a href="data-visualization.html#overlaying-plots"><i class="fa fa-check"></i><b>4.10</b> Overlaying Plots</a></li>
<li class="chapter" data-level="4.11" data-path="data-visualization.html"><a href="data-visualization.html#combining-different-plots"><i class="fa fa-check"></i><b>4.11</b> Combining Different Plots</a></li>
<li class="chapter" data-level="4.12" data-path="data-visualization.html"><a href="data-visualization.html#statistical-transformation"><i class="fa fa-check"></i><b>4.12</b> Statistical Transformation</a></li>
<li class="chapter" data-level="4.13" data-path="data-visualization.html"><a href="data-visualization.html#customizing-title"><i class="fa fa-check"></i><b>4.13</b> Customizing Title</a></li>
<li class="chapter" data-level="4.14" data-path="data-visualization.html"><a href="data-visualization.html#adjusting-axes"><i class="fa fa-check"></i><b>4.14</b> Adjusting Axes</a></li>
<li class="chapter" data-level="4.15" data-path="data-visualization.html"><a href="data-visualization.html#choosing-themes"><i class="fa fa-check"></i><b>4.15</b> Choosing Themes</a></li>
<li class="chapter" data-level="4.16" data-path="data-visualization.html"><a href="data-visualization.html#saving-plots"><i class="fa fa-check"></i><b>4.16</b> Saving Plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling.html"><a href="data-wrangling.html#definition-of-data-wrangling"><i class="fa fa-check"></i><b>5.1</b> Definition of data wrangling</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling.html"><a href="data-wrangling.html#data-wrangling-with-dplyr-package"><i class="fa fa-check"></i><b>5.2</b> Data wrangling with <strong>dplyr</strong> package</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#dplyr-package"><i class="fa fa-check"></i><b>5.2.1</b> <strong>dplyr</strong> package</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling.html"><a href="data-wrangling.html#common-procedures-for-doing-data-transformation"><i class="fa fa-check"></i><b>5.3</b> Common procedures for doing data transformation</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling.html"><a href="data-wrangling.html#some-dplyr-functions"><i class="fa fa-check"></i><b>5.4</b> Some <strong>dplyr</strong> functions</a></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling.html"><a href="data-wrangling.html#create-a-new-project-or-set-your-working-directory"><i class="fa fa-check"></i><b>5.5</b> Create a new project or set your working directory</a></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling.html"><a href="data-wrangling.html#load-the-libraries"><i class="fa fa-check"></i><b>5.6</b> Load the libraries</a></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling.html"><a href="data-wrangling.html#datasets"><i class="fa fa-check"></i><b>5.7</b> Datasets</a></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling.html"><a href="data-wrangling.html#select-variables-generate-new-variable-and-rename-variable"><i class="fa fa-check"></i><b>5.8</b> Select variables, generate new variable and rename variable</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="data-wrangling.html"><a href="data-wrangling.html#select-variables-using-dplyrselect"><i class="fa fa-check"></i><b>5.8.1</b> Select variables using <code>dplyr::select()</code></a></li>
<li class="chapter" data-level="5.8.2" data-path="data-wrangling.html"><a href="data-wrangling.html#generate-new-variable-using-mutate"><i class="fa fa-check"></i><b>5.8.2</b> Generate new variable using <code>mutate()</code></a></li>
<li class="chapter" data-level="5.8.3" data-path="data-wrangling.html"><a href="data-wrangling.html#rename-variable-using-rename"><i class="fa fa-check"></i><b>5.8.3</b> Rename variable using <code>rename()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="data-wrangling.html"><a href="data-wrangling.html#sorting-data-and-select-observation"><i class="fa fa-check"></i><b>5.9</b> Sorting data and select observation</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data-wrangling.html"><a href="data-wrangling.html#sorting-data-using-arrange"><i class="fa fa-check"></i><b>5.9.1</b> Sorting data using <code>arrange()</code></a></li>
<li class="chapter" data-level="5.9.2" data-path="data-wrangling.html"><a href="data-wrangling.html#select-observation-using-filter"><i class="fa fa-check"></i><b>5.9.2</b> Select observation using <code>filter()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="data-wrangling.html"><a href="data-wrangling.html#group-data-and-get-summary-statistics"><i class="fa fa-check"></i><b>5.10</b> Group data and get summary statistics</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="data-wrangling.html"><a href="data-wrangling.html#group-data-using-group_by"><i class="fa fa-check"></i><b>5.10.1</b> Group data using <code>group_by()</code></a></li>
<li class="chapter" data-level="5.10.2" data-path="data-wrangling.html"><a href="data-wrangling.html#summary-statistic-using-summarize"><i class="fa fa-check"></i><b>5.10.2</b> Summary statistic using <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="data-wrangling.html"><a href="data-wrangling.html#more-complicated-dplyr-verbs"><i class="fa fa-check"></i><b>5.11</b> More complicated <strong>dplyr</strong> verbs</a></li>
<li class="chapter" data-level="5.12" data-path="data-wrangling.html"><a href="data-wrangling.html#data-transformation-for-categorical-variables"><i class="fa fa-check"></i><b>5.12</b> Data transformation for categorical variables</a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="data-wrangling.html"><a href="data-wrangling.html#forcats-package"><i class="fa fa-check"></i><b>5.12.1</b> <strong>forcats</strong> package</a></li>
<li class="chapter" data-level="5.12.2" data-path="data-wrangling.html"><a href="data-wrangling.html#conversion-from-numeric-to-factor-variables"><i class="fa fa-check"></i><b>5.12.2</b> Conversion from numeric to factor variables</a></li>
<li class="chapter" data-level="5.12.3" data-path="data-wrangling.html"><a href="data-wrangling.html#recoding-variables"><i class="fa fa-check"></i><b>5.12.3</b> Recoding variables</a></li>
<li class="chapter" data-level="5.12.4" data-path="data-wrangling.html"><a href="data-wrangling.html#changing-the-level-of-categorical-variable"><i class="fa fa-check"></i><b>5.12.4</b> Changing the level of categorical variable</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="data-wrangling.html"><a href="data-wrangling.html#summary"><i class="fa fa-check"></i><b>5.13</b> Summary</a></li>
<li class="chapter" data-level="5.14" data-path="data-wrangling.html"><a href="data-wrangling.html#self-practice"><i class="fa fa-check"></i><b>5.14</b> Self-practice</a></li>
<li class="chapter" data-level="5.15" data-path="data-wrangling.html"><a href="data-wrangling.html#references"><i class="fa fa-check"></i><b>5.15</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>6</b> R Markdown</a>
<ul>
<li class="chapter" data-level="6.1" data-path="r-markdown.html"><a href="r-markdown.html#motivation"><i class="fa fa-check"></i><b>6.1</b> Motivation</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="r-markdown.html"><a href="r-markdown.html#what-is-r-markdown"><i class="fa fa-check"></i><b>6.1.1</b> What is R Markdown?</a></li>
<li class="chapter" data-level="6.1.2" data-path="r-markdown.html"><a href="r-markdown.html#why-should-we-bother-learning-r-markdown"><i class="fa fa-check"></i><b>6.1.2</b> Why should we bother learning R Markdown?</a></li>
<li class="chapter" data-level="6.1.3" data-path="r-markdown.html"><a href="r-markdown.html#sources-to-learn-r-markdown"><i class="fa fa-check"></i><b>6.1.3</b> Sources to learn R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="r-markdown.html"><a href="r-markdown.html#r-markdown-basics"><i class="fa fa-check"></i><b>6.2</b> R Markdown Basics</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="r-markdown.html"><a href="r-markdown.html#install-rmarkdown-package"><i class="fa fa-check"></i><b>6.2.1</b> Install <code>rmarkdown</code> package</a></li>
<li class="chapter" data-level="6.2.2" data-path="r-markdown.html"><a href="r-markdown.html#install-latex-package-for-pdf"><i class="fa fa-check"></i><b>6.2.2</b> Install LaTeX package for PDF</a></li>
<li class="chapter" data-level="6.2.3" data-path="r-markdown.html"><a href="r-markdown.html#new-.rmd-file"><i class="fa fa-check"></i><b>6.2.3</b> New .Rmd file</a></li>
<li class="chapter" data-level="6.2.4" data-path="r-markdown.html"><a href="r-markdown.html#knit-it"><i class="fa fa-check"></i><b>6.2.4</b> Knit it!</a></li>
<li class="chapter" data-level="6.2.5" data-path="r-markdown.html"><a href="r-markdown.html#yaml-header"><i class="fa fa-check"></i><b>6.2.5</b> YAML header</a></li>
<li class="chapter" data-level="6.2.6" data-path="r-markdown.html"><a href="r-markdown.html#code-chunks"><i class="fa fa-check"></i><b>6.2.6</b> Code chunks</a></li>
<li class="chapter" data-level="6.2.7" data-path="r-markdown.html"><a href="r-markdown.html#header-levels"><i class="fa fa-check"></i><b>6.2.7</b> Header levels</a></li>
<li class="chapter" data-level="6.2.8" data-path="r-markdown.html"><a href="r-markdown.html#exercise-1"><i class="fa fa-check"></i><b>6.2.8</b> Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="r-markdown.html"><a href="r-markdown.html#table"><i class="fa fa-check"></i><b>6.3</b> Table</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="r-markdown.html"><a href="r-markdown.html#basic-table"><i class="fa fa-check"></i><b>6.3.1</b> Basic table</a></li>
<li class="chapter" data-level="6.3.2" data-path="r-markdown.html"><a href="r-markdown.html#table-from-data-frame"><i class="fa fa-check"></i><b>6.3.2</b> Table (from data frame)</a></li>
<li class="chapter" data-level="6.3.3" data-path="r-markdown.html"><a href="r-markdown.html#more-on-table"><i class="fa fa-check"></i><b>6.3.3</b> More on table</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="r-markdown.html"><a href="r-markdown.html#plot-figure-and-image"><i class="fa fa-check"></i><b>6.4</b> Plot, figure and image</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="r-markdown.html"><a href="r-markdown.html#plot-caption-fig.cap"><i class="fa fa-check"></i><b>6.4.1</b> Plot caption – <code>fig.cap</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="r-markdown.html"><a href="r-markdown.html#plot-size-fig.heightin-inch"><i class="fa fa-check"></i><b>6.4.2</b> Plot size – <code>fig.height</code>(in inch)</a></li>
<li class="chapter" data-level="6.4.3" data-path="r-markdown.html"><a href="r-markdown.html#plot-size-fig.width-in-inch"><i class="fa fa-check"></i><b>6.4.3</b> Plot size – <code>fig.width</code> (in inch)</a></li>
<li class="chapter" data-level="6.4.4" data-path="r-markdown.html"><a href="r-markdown.html#plot-aspect-ratio-fig.asp"><i class="fa fa-check"></i><b>6.4.4</b> Plot aspect ratio – <code>fig.asp</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="r-markdown.html"><a href="r-markdown.html#image"><i class="fa fa-check"></i><b>6.5</b> Image</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="r-markdown.html"><a href="r-markdown.html#exercise-2"><i class="fa fa-check"></i><b>6.5.1</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="r-markdown.html"><a href="r-markdown.html#inline-output"><i class="fa fa-check"></i><b>6.6</b> Inline output</a></li>
<li class="chapter" data-level="6.7" data-path="r-markdown.html"><a href="r-markdown.html#equation"><i class="fa fa-check"></i><b>6.7</b> Equation</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="r-markdown.html"><a href="r-markdown.html#mathematical-equation"><i class="fa fa-check"></i><b>6.7.1</b> Mathematical equation</a></li>
<li class="chapter" data-level="6.7.2" data-path="r-markdown.html"><a href="r-markdown.html#inline-equation"><i class="fa fa-check"></i><b>6.7.2</b> Inline equation</a></li>
<li class="chapter" data-level="6.7.3" data-path="r-markdown.html"><a href="r-markdown.html#display-equation"><i class="fa fa-check"></i><b>6.7.3</b> Display equation</a></li>
<li class="chapter" data-level="6.7.4" data-path="r-markdown.html"><a href="r-markdown.html#exercise-3"><i class="fa fa-check"></i><b>6.7.4</b> Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html"><i class="fa fa-check"></i><b>7</b> Exploratory data analysis (EDA)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#motivation-1"><i class="fa fa-check"></i><b>7.1</b> Motivation</a></li>
<li class="chapter" data-level="7.2" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#questions-to-ask-before-making-graphs"><i class="fa fa-check"></i><b>7.2</b> Questions to ask before making graphs</a></li>
<li class="chapter" data-level="7.3" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#eda-using-ggplot2-package"><i class="fa fa-check"></i><b>7.3</b> EDA using ggplot2 package</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#usage-of-ggplot2"><i class="fa fa-check"></i><b>7.3.1</b> Usage of <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#loading-the-library"><i class="fa fa-check"></i><b>7.4</b> Loading the library</a></li>
<li class="chapter" data-level="7.5" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#the-dataset"><i class="fa fa-check"></i><b>7.5</b> The dataset</a></li>
<li class="chapter" data-level="7.6" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>7.6</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#statistics"><i class="fa fa-check"></i><b>7.6.1</b> Statistics</a></li>
<li class="chapter" data-level="7.6.2" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#plots"><i class="fa fa-check"></i><b>7.6.2</b> Plots</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#one-variable-distribution-of-a-categorical-variable"><i class="fa fa-check"></i><b>7.7</b> One variable: Distribution of a categorical variable</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#bar-chart"><i class="fa fa-check"></i><b>7.7.1</b> Bar chart</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#one-variable-distribution-of-a-numerical-variable"><i class="fa fa-check"></i><b>7.8</b> One variable: Distribution of a numerical variable</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#histogram"><i class="fa fa-check"></i><b>7.8.1</b> Histogram</a></li>
<li class="chapter" data-level="7.8.2" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#density-curve"><i class="fa fa-check"></i><b>7.8.2</b> Density curve</a></li>
<li class="chapter" data-level="7.8.3" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#histogram-and-density-curve-together"><i class="fa fa-check"></i><b>7.8.3</b> Histogram and density curve together</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#two-variables-plotting-a-numerical-and-a-categorical-variable"><i class="fa fa-check"></i><b>7.9</b> Two variables: Plotting a numerical and a categorical variable</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#overlaying-histogramss-and-boxplot"><i class="fa fa-check"></i><b>7.9.1</b> Overlaying histogramss and boxplot</a></li>
<li class="chapter" data-level="7.9.2" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#faceting-the-plots"><i class="fa fa-check"></i><b>7.9.2</b> Faceting the plots</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#line-plot"><i class="fa fa-check"></i><b>7.10</b> Line plot</a></li>
<li class="chapter" data-level="7.11" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#plotting-means-and-error-bars"><i class="fa fa-check"></i><b>7.11</b> Plotting means and error bars</a></li>
<li class="chapter" data-level="7.12" data-path="exploratory-data-analysis-eda.html"><a href="exploratory-data-analysis-eda.html#scatterplot-with-fit-line"><i class="fa fa-check"></i><b>7.12</b> Scatterplot with fit line</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>8</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression-slr"><i class="fa fa-check"></i><b>8.1</b> Simple linear regression (SLR)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="linear-regression.html"><a href="linear-regression.html#about-slr"><i class="fa fa-check"></i><b>8.1.1</b> About SLR</a></li>
<li class="chapter" data-level="8.1.2" data-path="linear-regression.html"><a href="linear-regression.html#analysis"><i class="fa fa-check"></i><b>8.1.2</b> Analysis</a></li>
<li class="chapter" data-level="8.1.3" data-path="linear-regression.html"><a href="linear-regression.html#data-exploration"><i class="fa fa-check"></i><b>8.1.3</b> Data exploration</a></li>
<li class="chapter" data-level="8.1.4" data-path="linear-regression.html"><a href="linear-regression.html#univariable"><i class="fa fa-check"></i><b>8.1.4</b> Univariable</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression-mlr"><i class="fa fa-check"></i><b>8.2</b> Multiple linear regression (MLR)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="linear-regression.html"><a href="linear-regression.html#about-mlr"><i class="fa fa-check"></i><b>8.2.1</b> About MLR</a></li>
<li class="chapter" data-level="8.2.2" data-path="linear-regression.html"><a href="linear-regression.html#analysis-1"><i class="fa fa-check"></i><b>8.2.2</b> Analysis</a></li>
<li class="chapter" data-level="8.2.3" data-path="linear-regression.html"><a href="linear-regression.html#multicollinearity-mc"><i class="fa fa-check"></i><b>8.2.3</b> Multicollinearity, MC</a></li>
<li class="chapter" data-level="8.2.4" data-path="linear-regression.html"><a href="linear-regression.html#interaction"><i class="fa fa-check"></i><b>8.2.4</b> Interaction, *</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="linear-regression.html"><a href="linear-regression.html#model-fit-assessment-residuals"><i class="fa fa-check"></i><b>8.3</b> Model fit assessment: Residuals</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#histogram-1"><i class="fa fa-check"></i>Histogram</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#scatter-plots"><i class="fa fa-check"></i>Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="linear-regression.html"><a href="linear-regression.html#interpretation-1"><i class="fa fa-check"></i><b>8.4</b> Interpretation</a></li>
<li class="chapter" data-level="8.5" data-path="linear-regression.html"><a href="linear-regression.html#model-equation-1"><i class="fa fa-check"></i><b>8.5</b> Model equation</a></li>
<li class="chapter" data-level="8.6" data-path="linear-regression.html"><a href="linear-regression.html#prediction"><i class="fa fa-check"></i><b>8.6</b> Prediction</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html"><i class="fa fa-check"></i><b>9</b> Binary Logistic Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#background"><i class="fa fa-check"></i><b>9.1.1</b> Background</a></li>
<li class="chapter" data-level="9.1.2" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#objectives-1"><i class="fa fa-check"></i><b>9.1.2</b> Objectives</a></li>
<li class="chapter" data-level="9.1.3" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#further-readings"><i class="fa fa-check"></i><b>9.1.3</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#dataset"><i class="fa fa-check"></i><b>9.2</b> Dataset</a></li>
<li class="chapter" data-level="9.3" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#the-logit-and-logistic-models"><i class="fa fa-check"></i><b>9.3</b> The logit and logistic models</a></li>
<li class="chapter" data-level="9.4" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#prepare-environment-for-analysis"><i class="fa fa-check"></i><b>9.4</b> Prepare environment for analysis</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#creating-a-rstudio-project"><i class="fa fa-check"></i><b>9.4.1</b> Creating a RStudio project</a></li>
<li class="chapter" data-level="9.4.2" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#loading-libraries"><i class="fa fa-check"></i><b>9.4.2</b> Loading libraries</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#read-data-1"><i class="fa fa-check"></i><b>9.5</b> Read data</a></li>
<li class="chapter" data-level="9.6" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#explore-data"><i class="fa fa-check"></i><b>9.6</b> Explore data</a></li>
<li class="chapter" data-level="9.7" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#estimate-the-regression-parameters"><i class="fa fa-check"></i><b>9.7</b> Estimate the regression parameters</a></li>
<li class="chapter" data-level="9.8" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#simple-binary-logistic-regression"><i class="fa fa-check"></i><b>9.8</b> Simple binary logistic regression</a></li>
<li class="chapter" data-level="9.9" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#multiple-binary-logistic-regression"><i class="fa fa-check"></i><b>9.9</b> Multiple binary logistic regression</a></li>
<li class="chapter" data-level="9.10" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#convert-the-log-odds-to-odds-ratio"><i class="fa fa-check"></i><b>9.10</b> Convert the log odds to odds ratio</a></li>
<li class="chapter" data-level="9.11" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#making-inference"><i class="fa fa-check"></i><b>9.11</b> Making inference</a></li>
<li class="chapter" data-level="9.12" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#model-comparison"><i class="fa fa-check"></i><b>9.12</b> Model comparison</a></li>
<li class="chapter" data-level="9.13" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#adding-an-interaction-term"><i class="fa fa-check"></i><b>9.13</b> Adding an interaction term</a></li>
<li class="chapter" data-level="9.14" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#prediction-from-binary-logistic-regression"><i class="fa fa-check"></i><b>9.14</b> Prediction from binary logistic regression</a>
<ul>
<li class="chapter" data-level="9.14.1" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#predict-the-log-odds"><i class="fa fa-check"></i><b>9.14.1</b> Predict the log odds</a></li>
<li class="chapter" data-level="9.14.2" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#predict-the-probabilities"><i class="fa fa-check"></i><b>9.14.2</b> Predict the probabilities</a></li>
</ul></li>
<li class="chapter" data-level="9.15" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#model-fitness"><i class="fa fa-check"></i><b>9.15</b> Model fitness</a></li>
<li class="chapter" data-level="9.16" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#presentation"><i class="fa fa-check"></i><b>9.16</b> Presentation</a></li>
<li class="chapter" data-level="9.17" data-path="binary-logistic-regression.html"><a href="binary-logistic-regression.html#references-1"><i class="fa fa-check"></i><b>9.17</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>10</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="poisson-regression.html"><a href="poisson-regression.html#introduction-2"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="poisson-regression.html"><a href="poisson-regression.html#preliminaries"><i class="fa fa-check"></i><b>10.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="poisson-regression.html"><a href="poisson-regression.html#load-libraries"><i class="fa fa-check"></i><b>10.2.1</b> Load libraries</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="poisson-regression.html"><a href="poisson-regression.html#simple-poisson-regression-models"><i class="fa fa-check"></i><b>10.3</b> Simple Poisson regression models</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="poisson-regression.html"><a href="poisson-regression.html#count-data"><i class="fa fa-check"></i><b>10.3.1</b> Count data</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="poisson-regression.html"><a href="poisson-regression.html#rate-data"><i class="fa fa-check"></i><b>10.4</b> Rate data</a></li>
<li class="chapter" data-level="10.5" data-path="poisson-regression.html"><a href="poisson-regression.html#multiple-poisson-regression-model"><i class="fa fa-check"></i><b>10.5</b> Multiple Poisson regression model</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="poisson-regression.html"><a href="poisson-regression.html#univariable-1"><i class="fa fa-check"></i><b>10.5.1</b> Univariable</a></li>
<li class="chapter" data-level="10.5.2" data-path="poisson-regression.html"><a href="poisson-regression.html#multivariable-1"><i class="fa fa-check"></i><b>10.5.2</b> Multivariable</a></li>
<li class="chapter" data-level="10.5.3" data-path="poisson-regression.html"><a href="poisson-regression.html#interaction-1"><i class="fa fa-check"></i><b>10.5.3</b> Interaction</a></li>
<li class="chapter" data-level="10.5.4" data-path="poisson-regression.html"><a href="poisson-regression.html#final-model"><i class="fa fa-check"></i><b>10.5.4</b> Final model</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="poisson-regression.html"><a href="poisson-regression.html#references-2"><i class="fa fa-check"></i><b>10.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>11</b> Survival Analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="survival-analysis.html"><a href="survival-analysis.html#introduction-3"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="survival-analysis.html"><a href="survival-analysis.html#background-1"><i class="fa fa-check"></i><b>11.1.1</b> Background</a></li>
<li class="chapter" data-level="11.1.2" data-path="survival-analysis.html"><a href="survival-analysis.html#types-of-survival-analysis"><i class="fa fa-check"></i><b>11.1.2</b> Types of survival analysis</a></li>
<li class="chapter" data-level="11.1.3" data-path="survival-analysis.html"><a href="survival-analysis.html#objectives-2"><i class="fa fa-check"></i><b>11.1.3</b> Objectives</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="survival-analysis.html"><a href="survival-analysis.html#prepare-environment-for-analysis-1"><i class="fa fa-check"></i><b>11.2</b> Prepare environment for analysis</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="survival-analysis.html"><a href="survival-analysis.html#rstudio-project-1"><i class="fa fa-check"></i><b>11.2.1</b> RStudio project</a></li>
<li class="chapter" data-level="11.2.2" data-path="survival-analysis.html"><a href="survival-analysis.html#packages-1"><i class="fa fa-check"></i><b>11.2.2</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="survival-analysis.html"><a href="survival-analysis.html#data"><i class="fa fa-check"></i><b>11.3</b> Data</a></li>
<li class="chapter" data-level="11.4" data-path="survival-analysis.html"><a href="survival-analysis.html#exploratory-data"><i class="fa fa-check"></i><b>11.4</b> Exploratory data</a></li>
<li class="chapter" data-level="11.5" data-path="survival-analysis.html"><a href="survival-analysis.html#kaplan-meier-survival-estimates"><i class="fa fa-check"></i><b>11.5</b> Kaplan-Meier survival estimates</a></li>
<li class="chapter" data-level="11.6" data-path="survival-analysis.html"><a href="survival-analysis.html#plot-the-survival-probability"><i class="fa fa-check"></i><b>11.6</b> Plot the survival probability</a></li>
<li class="chapter" data-level="11.7" data-path="survival-analysis.html"><a href="survival-analysis.html#comparing-kaplan-meier-estimates-across-groups"><i class="fa fa-check"></i><b>11.7</b> Comparing Kaplan-Meier estimates across groups</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="survival-analysis.html"><a href="survival-analysis.html#log-rank-test"><i class="fa fa-check"></i><b>11.7.1</b> Log-rank test</a></li>
<li class="chapter" data-level="11.7.2" data-path="survival-analysis.html"><a href="survival-analysis.html#peto-peto-test"><i class="fa fa-check"></i><b>11.7.2</b> peto-peto test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="survival-analysis.html"><a href="survival-analysis.html#semi-parametric-models-in-survival-analysis"><i class="fa fa-check"></i><b>11.8</b> Semi-parametric models in survival analysis</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="survival-analysis.html"><a href="survival-analysis.html#cox-proportional-hazard-regression"><i class="fa fa-check"></i><b>11.8.1</b> Cox proportional hazard regression</a></li>
<li class="chapter" data-level="11.8.2" data-path="survival-analysis.html"><a href="survival-analysis.html#advantages-of-the-cox-proportional-hazard-regression"><i class="fa fa-check"></i><b>11.8.2</b> Advantages of the Cox proportional hazard regression</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="survival-analysis.html"><a href="survival-analysis.html#estimation-from-cox-proportional-hazards-regression"><i class="fa fa-check"></i><b>11.9</b> Estimation from Cox proportional hazards regression</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="survival-analysis.html"><a href="survival-analysis.html#simple-cox-ph-regression"><i class="fa fa-check"></i><b>11.9.1</b> Simple Cox PH regression</a></li>
<li class="chapter" data-level="11.9.2" data-path="survival-analysis.html"><a href="survival-analysis.html#multiple-cox-ph-regression"><i class="fa fa-check"></i><b>11.9.2</b> Multiple Cox PH regression</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="survival-analysis.html"><a href="survival-analysis.html#inference"><i class="fa fa-check"></i><b>11.10</b> Inference</a></li>
<li class="chapter" data-level="11.11" data-path="survival-analysis.html"><a href="survival-analysis.html#adding-interaction-in-the-model"><i class="fa fa-check"></i><b>11.11</b> Adding interaction in the model</a></li>
<li class="chapter" data-level="11.12" data-path="survival-analysis.html"><a href="survival-analysis.html#the-proportional-hazard-assumption"><i class="fa fa-check"></i><b>11.12</b> The proportional hazard assumption</a>
<ul>
<li class="chapter" data-level="11.12.1" data-path="survival-analysis.html"><a href="survival-analysis.html#risk-constant-over-time"><i class="fa fa-check"></i><b>11.12.1</b> Risk constant over time</a></li>
<li class="chapter" data-level="11.12.2" data-path="survival-analysis.html"><a href="survival-analysis.html#test-for-ph-assumption"><i class="fa fa-check"></i><b>11.12.2</b> Test for PH assumption</a></li>
<li class="chapter" data-level="11.12.3" data-path="survival-analysis.html"><a href="survival-analysis.html#plots-to-assess-ph-assumption"><i class="fa fa-check"></i><b>11.12.3</b> Plots to assess PH assumption</a></li>
</ul></li>
<li class="chapter" data-level="11.13" data-path="survival-analysis.html"><a href="survival-analysis.html#model-checking"><i class="fa fa-check"></i><b>11.13</b> Model checking</a>
<ul>
<li class="chapter" data-level="11.13.1" data-path="survival-analysis.html"><a href="survival-analysis.html#prediction-from-cox-ph-model"><i class="fa fa-check"></i><b>11.13.1</b> Prediction from Cox PH model</a></li>
<li class="chapter" data-level="11.13.2" data-path="survival-analysis.html"><a href="survival-analysis.html#residuas-from-cox-ph-model"><i class="fa fa-check"></i><b>11.13.2</b> Residuas from Cox PH model</a></li>
<li class="chapter" data-level="11.13.3" data-path="survival-analysis.html"><a href="survival-analysis.html#influential-observations"><i class="fa fa-check"></i><b>11.13.3</b> Influential observations</a></li>
</ul></li>
<li class="chapter" data-level="11.14" data-path="survival-analysis.html"><a href="survival-analysis.html#plot-the-adjusted-survival"><i class="fa fa-check"></i><b>11.14</b> Plot the adjusted survival</a></li>
<li class="chapter" data-level="11.15" data-path="survival-analysis.html"><a href="survival-analysis.html#presentation-and-interpretation"><i class="fa fa-check"></i><b>11.15</b> Presentation and interpretation</a></li>
<li class="chapter" data-level="11.16" data-path="survival-analysis.html"><a href="survival-analysis.html#references-3"><i class="fa fa-check"></i><b>11.16</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="missing-data.html"><a href="missing-data.html"><i class="fa fa-check"></i><b>12</b> Missing data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="missing-data.html"><a href="missing-data.html#introduction-4"><i class="fa fa-check"></i><b>12.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="missing-data.html"><a href="missing-data.html#background-2"><i class="fa fa-check"></i><b>12.1.1</b> Background</a></li>
<li class="chapter" data-level="12.1.2" data-path="missing-data.html"><a href="missing-data.html#objectives-3"><i class="fa fa-check"></i><b>12.1.2</b> Objectives</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="missing-data.html"><a href="missing-data.html#preliminaries-1"><i class="fa fa-check"></i><b>12.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="missing-data.html"><a href="missing-data.html#packages-2"><i class="fa fa-check"></i><b>12.2.1</b> Packages</a></li>
<li class="chapter" data-level="12.2.2" data-path="missing-data.html"><a href="missing-data.html#dataset-1"><i class="fa fa-check"></i><b>12.2.2</b> Dataset</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="missing-data.html"><a href="missing-data.html#exploring-missing-data"><i class="fa fa-check"></i><b>12.3</b> Exploring missing data</a></li>
<li class="chapter" data-level="12.4" data-path="missing-data.html"><a href="missing-data.html#handling-missing-data"><i class="fa fa-check"></i><b>12.4</b> Handling missing data</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="missing-data.html"><a href="missing-data.html#listwise-deletion"><i class="fa fa-check"></i><b>12.4.1</b> Listwise deletion</a></li>
<li class="chapter" data-level="12.4.2" data-path="missing-data.html"><a href="missing-data.html#simple-imputation"><i class="fa fa-check"></i><b>12.4.2</b> Simple imputation</a></li>
<li class="chapter" data-level="12.4.3" data-path="missing-data.html"><a href="missing-data.html#single-imputation"><i class="fa fa-check"></i><b>12.4.3</b> Single imputation</a></li>
<li class="chapter" data-level="12.4.4" data-path="missing-data.html"><a href="missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>12.4.4</b> Multiple imputation</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="missing-data.html"><a href="missing-data.html#presentation-1"><i class="fa fa-check"></i><b>12.5</b> Presentation</a></li>
<li class="chapter" data-level="12.6" data-path="missing-data.html"><a href="missing-data.html#references-4"><i class="fa fa-check"></i><b>12.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-5.html"><a href="references-5.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in Medicine and Health using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="poisson-regression" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Poisson Regression</h1>
<div id="introduction-2" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Introduction</h2>
<p>Multiple Poisson Regression for count is given as
<span class="math display">\[ln\,E(Y|\mathbf{X})=ln\,\mu=\beta_{0}+\beta_{1}X_{1}+\cdots+\beta_{p-1}X_{p-1}=\beta_{0}+\sum\beta_{p-1}X_{p-1}\]</span>
where the <strong>X</strong> (in bold) denotes a collection of Xs. <em>p</em> is the number of estimated parameters.</p>
<p>Multiple Poisson Regression for rate with offset<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> is given as
<span class="math display">\[ln\,E(Y|\mathbf{X})=ln\,a(\mathbf{X})+\beta_{0}+\sum\beta_{p-1}X_{p-1}\]</span>
The rate ratio, RR is
<span class="math display">\[RR=e^{\beta_{p-1}}\]</span></p>
</div>
<div id="preliminaries" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Preliminaries</h2>
<div id="load-libraries" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Load libraries</h3>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="poisson-regression.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiDisplay)</span>
<span id="cb383-2"><a href="poisson-regression.html#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
</div>
</div>
<div id="simple-poisson-regression-models" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Simple Poisson regression models</h2>
<div id="count-data" class="section level3" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Count data</h3>
<div id="x-categorical" class="section level4" number="10.3.1.1">
<h4><span class="header-section-number">10.3.1.1</span> X categorical</h4>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="poisson-regression.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - UKaccident.csv is modified from builtin data Seatbelts</span></span>
<span id="cb384-2"><a href="poisson-regression.html#cb384-2" aria-hidden="true" tabindex="-1"></a>acc <span class="ot">=</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;UKaccident.csv&quot;</span>))</span>
<span id="cb384-3"><a href="poisson-regression.html#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co">#- driverskilled: number of death</span></span>
<span id="cb384-4"><a href="poisson-regression.html#cb384-4" aria-hidden="true" tabindex="-1"></a><span class="co">#- law: before seatbelt law = 0, after law = 1</span></span>
<span id="cb384-5"><a href="poisson-regression.html#cb384-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(acc)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    122 obs. of  2 variables:
##  $ driverskilled: int  107 97 102 87 119 106 110 106 107 125 ...
##  $ law          : int  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="poisson-regression.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(acc); <span class="fu">tail</span>(acc)</span></code></pre></div>
<pre><code>##   driverskilled law
## 1           107   0
## 2            97   0
## 3           102   0
## 4            87   0
## 5           119   0
## 6           106   0</code></pre>
<pre><code>##     driverskilled law
## 117            81   1
## 118            84   1
## 119            87   1
## 120            90   1
## 121            79   1
## 122            96   1</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="poisson-regression.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - some descriptives</span></span>
<span id="cb389-2"><a href="poisson-regression.html#cb389-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(acc<span class="sc">$</span>driverskilled, acc<span class="sc">$</span>law, sum)  <span class="co"># total death before vs after</span></span></code></pre></div>
<pre><code>##     0     1 
## 11826  1294</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="poisson-regression.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(acc<span class="sc">$</span>law)  <span class="co"># num of observations before vs after</span></span></code></pre></div>
<pre><code>## 
##   0   1 
## 107  15</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="poisson-regression.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - mean count, manually</span></span>
<span id="cb393-2"><a href="poisson-regression.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="dv">11826</span><span class="sc">/</span><span class="dv">107</span>  <span class="co"># 110.5234, count before law</span></span></code></pre></div>
<pre><code>## [1] 110.5234</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="poisson-regression.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1294</span><span class="sc">/</span><span class="dv">15</span>  <span class="co"># 86.26667, count after law</span></span></code></pre></div>
<pre><code>## [1] 86.26667</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="poisson-regression.html#cb397-1" aria-hidden="true" tabindex="-1"></a>model.acc <span class="ot">=</span> <span class="fu">glm</span>(driverskilled <span class="sc">~</span> law, <span class="at">data =</span> acc, <span class="at">family =</span> poisson)</span>
<span id="cb397-2"><a href="poisson-regression.html#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.acc)  <span class="co"># significant p based on Wald test</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = driverskilled ~ law, family = poisson, data = acc)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -3.16127  -0.72398   0.04531   0.77308   1.89182  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  4.705227   0.009196 511.681   &lt;2e-16 ***
## law         -0.247784   0.029281  -8.462   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 219.17  on 121  degrees of freedom
## Residual deviance: 142.64  on 120  degrees of freedom
## AIC: 940.7
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="poisson-regression.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - to get CI</span></span>
<span id="cb399-2"><a href="poisson-regression.html#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">coef</span>(model.acc), <span class="fu">confint</span>(model.acc))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                             2.5 %     97.5 %
## (Intercept)  4.7052269  4.6871495  4.7231960
## law         -0.2477837 -0.3056189 -0.1908312</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="poisson-regression.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - ln(count) = 4.71 - 0.25*LAW</span></span>
<span id="cb402-2"><a href="poisson-regression.html#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="fl">4.71</span> <span class="sc">-</span> <span class="fl">0.25</span>  <span class="co"># = 4.46</span></span></code></pre></div>
<pre><code>## [1] 4.46</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="poisson-regression.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">4.71</span>)  <span class="co"># 111.0522, count before law</span></span></code></pre></div>
<pre><code>## [1] 111.0522</code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="poisson-regression.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">4.46</span>)  <span class="co"># 86.48751, count after law</span></span></code></pre></div>
<pre><code>## [1] 86.48751</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="poisson-regression.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Model fit</span></span>
<span id="cb408-2"><a href="poisson-regression.html#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="fu">poisgof</span>(model.acc)  <span class="co"># fit well, based on chi-square test on the residual deviance</span></span></code></pre></div>
<pre><code>## $results
## [1] &quot;Goodness-of-fit test for Poisson assumption&quot;
## 
## $chisq
## [1] 142.6436
## 
## $df
## [1] 120
## 
## $p.value
## [1] 0.07764771</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="poisson-regression.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Diagnostics</span></span>
<span id="cb410-2"><a href="poisson-regression.html#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   - standardized residuals</span></span>
<span id="cb410-3"><a href="poisson-regression.html#cb410-3" aria-hidden="true" tabindex="-1"></a>sr <span class="ot">=</span> <span class="fu">rstandard</span>(model.acc)</span>
<span id="cb410-4"><a href="poisson-regression.html#cb410-4" aria-hidden="true" tabindex="-1"></a>sr[<span class="fu">abs</span>(sr) <span class="sc">&gt;</span> <span class="fl">1.96</span>]</span></code></pre></div>
<pre><code>##         4        54        55        91       113 
## -2.335861 -3.176147 -2.857937 -2.647896 -3.098644</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="poisson-regression.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   - predicted count vs fitted values</span></span>
<span id="cb412-2"><a href="poisson-regression.html#cb412-2" aria-hidden="true" tabindex="-1"></a>fitted.acc <span class="ot">=</span> model.acc<span class="sc">$</span>fitted</span>
<span id="cb412-3"><a href="poisson-regression.html#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(acc, fitted.acc)[<span class="fu">names</span>(sr[<span class="fu">abs</span>(sr) <span class="sc">&gt;</span> <span class="fl">1.96</span>]),]  <span class="co"># look at the discrepancies</span></span></code></pre></div>
<pre><code>##     driverskilled law fitted.acc
## 4              87   0  110.52336
## 54             79   0  110.52336
## 55             82   0  110.52336
## 91             84   0  110.52336
## 113            60   1   86.26667</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="poisson-regression.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary with RR</span></span>
<span id="cb414-2"><a href="poisson-regression.html#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="fu">idr.display</span>(model.acc)  <span class="co"># easier, also view LR test</span></span></code></pre></div>
<pre><code>## 
## Poisson regression predicting driverskilled 
##  
##              IDR(95%CI)        P(Wald&#39;s test) P(LR-test)
## law: 1 vs 0  0.78 (0.74,0.83)  &lt; 0.001        &lt; 0.001   
##                                                         
## Log-likelihood = -468.3481
## No. of observations = 122
## AIC value = 940.6963</code></pre>
</div>
<div id="x-numerical" class="section level4" number="10.3.1.2">
<h4><span class="header-section-number">10.3.1.2</span> X numerical</h4>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="poisson-regression.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Data from https://stats.idre.ucla.edu/stat/data/poisson_sim.csv</span></span>
<span id="cb416-2"><a href="poisson-regression.html#cb416-2" aria-hidden="true" tabindex="-1"></a>aw <span class="ot">=</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;poisson_sim.csv&quot;</span>))</span>
<span id="cb416-3"><a href="poisson-regression.html#cb416-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aw); <span class="fu">tail</span>(aw)</span></code></pre></div>
<pre><code>##    id num_awards prog math
## 1  45          0    3   41
## 2 108          0    1   41
## 3  15          0    3   44
## 4  67          0    3   42
## 5 153          0    3   40
## 6  51          0    1   42</code></pre>
<pre><code>##      id num_awards prog math
## 195  61          1    2   60
## 196 100          2    2   71
## 197 143          2    3   75
## 198  68          1    2   71
## 199  57          0    2   72
## 200 132          3    2   73</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="poisson-regression.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(aw)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    200 obs. of  4 variables:
##  $ id        : int  45 108 15 67 153 51 164 133 2 53 ...
##  $ num_awards: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ prog      : int  3 1 3 3 3 1 3 3 3 3 ...
##  $ math      : int  41 41 44 42 40 42 46 40 33 46 ...</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="poisson-regression.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co">#- num_awards: The number of awards earned by students at one high school.</span></span>
<span id="cb421-2"><a href="poisson-regression.html#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="co">#- math: the score on their final exam in math.</span></span>
<span id="cb421-3"><a href="poisson-regression.html#cb421-3" aria-hidden="true" tabindex="-1"></a>model.aw <span class="ot">=</span> <span class="fu">glm</span>(num_awards <span class="sc">~</span> math, <span class="at">data =</span> aw, <span class="at">family =</span> poisson)</span>
<span id="cb421-4"><a href="poisson-regression.html#cb421-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.aw)  <span class="co"># math sig.</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = num_awards ~ math, family = poisson, data = aw)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1853  -0.9070  -0.6001   0.3246   2.9529  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -5.333532   0.591261  -9.021   &lt;2e-16 ***
## math         0.086166   0.009679   8.902   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 287.67  on 199  degrees of freedom
## Residual deviance: 204.02  on 198  degrees of freedom
## AIC: 384.08
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="poisson-regression.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">coef</span>(model.aw), <span class="fu">confint</span>(model.aw))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>##                              2.5 %    97.5 %
## (Intercept) -5.3335321 -6.52038334 -4.200322
## math         0.0861656  0.06737466  0.105356</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="poisson-regression.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poisgof</span>(model.aw)  <span class="co"># fit well</span></span></code></pre></div>
<pre><code>## $results
## [1] &quot;Goodness-of-fit test for Poisson assumption&quot;
## 
## $chisq
## [1] 204.0213
## 
## $df
## [1] 198
## 
## $p.value
## [1] 0.3695697</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="poisson-regression.html#cb428-1" aria-hidden="true" tabindex="-1"></a>sr <span class="ot">=</span> <span class="fu">rstandard</span>(model.aw)</span>
<span id="cb428-2"><a href="poisson-regression.html#cb428-2" aria-hidden="true" tabindex="-1"></a>sr[<span class="fu">abs</span>(sr) <span class="sc">&gt;</span> <span class="fl">1.96</span>]</span></code></pre></div>
<pre><code>##        54       120       122       150       157       164       172       181 
##  2.740294  1.975409  2.015236  2.112331  2.963862  2.253872  2.112331  2.451774 
##       199 
## -2.241058</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="poisson-regression.html#cb430-1" aria-hidden="true" tabindex="-1"></a>aw_ <span class="ot">=</span> <span class="fu">data.frame</span>(aw[<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>)], <span class="at">predicted =</span> model.aw<span class="sc">$</span>fitted); <span class="fu">head</span>(aw_); <span class="fu">tail</span>(aw_)</span></code></pre></div>
<pre><code>##   math num_awards predicted
## 1   41          0 0.1651762
## 2   41          0 0.1651762
## 3   44          0 0.2139002
## 4   42          0 0.1800399
## 5   40          0 0.1515396
## 6   42          0 0.1800399</code></pre>
<pre><code>##     math num_awards predicted
## 195   60          1 0.8490848
## 196   71          2 2.1907094
## 197   75          2 3.0922155
## 198   71          1 2.1907094
## 199   72          0 2.3878444
## 200   73          3 2.6027189</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="poisson-regression.html#cb433-1" aria-hidden="true" tabindex="-1"></a>aw_[<span class="fu">names</span>(sr[<span class="fu">abs</span>(sr) <span class="sc">&gt;</span> <span class="fl">1.96</span>]),] <span class="co"># look at the discrepancies</span></span></code></pre></div>
<pre><code>##     math num_awards predicted
## 54    50          3 0.3587060
## 120   49          2 0.3290921
## 122   58          3 0.7146750
## 150   57          3 0.6556731
## 157   61          5 0.9254913
## 164   62          4 1.0087733
## 172   57          3 0.6556731
## 181   69          6 1.8439209
## 199   72          0 2.3878444</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="poisson-regression.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 unit increase in math score</span></span>
<span id="cb435-2"><a href="poisson-regression.html#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">idr.display</span>(model.aw)</span></code></pre></div>
<pre><code>## 
## Poisson regression predicting num_awards 
##  
##                   IDR(95%CI)        P(Wald&#39;s test) P(LR-test)
## math (cont. var.) 1.09 (1.07,1.11)  &lt; 0.001        &lt; 0.001   
##                                                              
## Log-likelihood = -190.0381
## No. of observations = 200
## AIC value = 384.0762</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="poisson-regression.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 10 unit increase in math score? Manually...</span></span>
<span id="cb437-2"><a href="poisson-regression.html#cb437-2" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="fu">coef</span>(model.aw)[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb437-3"><a href="poisson-regression.html#cb437-3" aria-hidden="true" tabindex="-1"></a>b1.ll <span class="ot">=</span> <span class="fu">confint</span>(model.aw)[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">10</span></span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="poisson-regression.html#cb439-1" aria-hidden="true" tabindex="-1"></a>b1.ul <span class="ot">=</span> <span class="fu">confint</span>(model.aw)[[<span class="dv">4</span>]]<span class="sc">*</span><span class="dv">10</span></span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="poisson-regression.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="st">&quot;Math RR&quot;</span> <span class="ot">=</span> b1, <span class="st">&quot;95% LL&quot;</span> <span class="ot">=</span> b1.ll, <span class="st">&quot;95% UL&quot;</span> <span class="ot">=</span> b1.ul))</span></code></pre></div>
<pre><code>##       Math RR   95% LL   95% UL
## [1,] 2.367077 1.961573 2.867842</code></pre>
</div>
</div>
</div>
<div id="rate-data" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Rate data</h2>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="poisson-regression.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - data in Fleiss et al 2003</span></span>
<span id="cb443-2"><a href="poisson-regression.html#cb443-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot; Table 12.1</span></span>
<span id="cb443-3"><a href="poisson-regression.html#cb443-3" aria-hidden="true" tabindex="-1"></a><span class="st">  cigar.day person.yrs cases        rate        pred</span></span>
<span id="cb443-4"><a href="poisson-regression.html#cb443-4" aria-hidden="true" tabindex="-1"></a><span class="st">1       0.0       1421     0 0.000000000 0.000793326</span></span>
<span id="cb443-5"><a href="poisson-regression.html#cb443-5" aria-hidden="true" tabindex="-1"></a><span class="st">2       5.2        927     0 0.000000000 0.001170787</span></span>
<span id="cb443-6"><a href="poisson-regression.html#cb443-6" aria-hidden="true" tabindex="-1"></a><span class="st">3      11.2        988     2 0.002024291 0.001834458</span></span>
<span id="cb443-7"><a href="poisson-regression.html#cb443-7" aria-hidden="true" tabindex="-1"></a><span class="st">4      15.9        849     2 0.002355713 0.002607843</span></span>
<span id="cb443-8"><a href="poisson-regression.html#cb443-8" aria-hidden="true" tabindex="-1"></a><span class="st">5      20.4       1567     9 0.005743459 0.003652195</span></span>
<span id="cb443-9"><a href="poisson-regression.html#cb443-9" aria-hidden="true" tabindex="-1"></a><span class="st">6      27.4       1409    10 0.007097232 0.006167215</span></span>
<span id="cb443-10"><a href="poisson-regression.html#cb443-10" aria-hidden="true" tabindex="-1"></a><span class="st">7      40.8        556     7 0.012589928 0.016813428</span></span>
<span id="cb443-11"><a href="poisson-regression.html#cb443-11" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<pre><code>## [1] &quot; Table 12.1\n  cigar.day person.yrs cases        rate        pred\n1       0.0       1421     0 0.000000000 0.000793326\n2       5.2        927     0 0.000000000 0.001170787\n3      11.2        988     2 0.002024291 0.001834458\n4      15.9        849     2 0.002355713 0.002607843\n5      20.4       1567     9 0.005743459 0.003652195\n6      27.4       1409    10 0.007097232 0.006167215\n7      40.8        556     7 0.012589928 0.016813428\n&quot;</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="poisson-regression.html#cb445-1" aria-hidden="true" tabindex="-1"></a>cigar.day <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">5.2</span>, <span class="fl">11.2</span>, <span class="fl">15.9</span>, <span class="fl">20.4</span>, <span class="fl">27.4</span>, <span class="fl">40.8</span>)</span>
<span id="cb445-2"><a href="poisson-regression.html#cb445-2" aria-hidden="true" tabindex="-1"></a>person.yrs <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1421</span>, <span class="dv">927</span>, <span class="dv">988</span>, <span class="dv">849</span>, <span class="dv">1567</span>, <span class="dv">1409</span>, <span class="dv">556</span>)</span>
<span id="cb445-3"><a href="poisson-regression.html#cb445-3" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">7</span>)</span>
<span id="cb445-4"><a href="poisson-regression.html#cb445-4" aria-hidden="true" tabindex="-1"></a>cig <span class="ot">=</span> <span class="fu">data.frame</span>(cigar.day, person.yrs, cases); cig</span></code></pre></div>
<pre><code>##   cigar.day person.yrs cases
## 1       0.0       1421     0
## 2       5.2        927     0
## 3      11.2        988     2
## 4      15.9        849     2
## 5      20.4       1567     9
## 6      27.4       1409    10
## 7      40.8        556     7</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="poisson-regression.html#cb447-1" aria-hidden="true" tabindex="-1"></a>cig<span class="sc">$</span>rate <span class="ot">=</span> cig<span class="sc">$</span>cases<span class="sc">/</span>cig<span class="sc">$</span>person.yrs; cig</span></code></pre></div>
<pre><code>##   cigar.day person.yrs cases        rate
## 1       0.0       1421     0 0.000000000
## 2       5.2        927     0 0.000000000
## 3      11.2        988     2 0.002024291
## 4      15.9        849     2 0.002355713
## 5      20.4       1567     9 0.005743459
## 6      27.4       1409    10 0.007097232
## 7      40.8        556     7 0.012589928</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="poisson-regression.html#cb449-1" aria-hidden="true" tabindex="-1"></a>model.cig <span class="ot">=</span> <span class="fu">glm</span>(cases <span class="sc">~</span> cigar.day, <span class="at">offset =</span> <span class="fu">log</span>(person.yrs), </span>
<span id="cb449-2"><a href="poisson-regression.html#cb449-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> cig, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb449-3"><a href="poisson-regression.html#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - it includes offset variable</span></span>
<span id="cb449-4"><a href="poisson-regression.html#cb449-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.cig)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cases ~ cigar.day, family = &quot;poisson&quot;, data = cig, 
##     offset = log(person.yrs))
## 
## Deviance Residuals: 
##       1        2        3        4        5        6        7  
## -1.5015  -1.4733   0.1370  -0.1463   1.2630   0.4340  -0.8041  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -7.13928    0.45402 -15.725  &lt; 2e-16 ***
## cigar.day    0.07485    0.01564   4.786  1.7e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 30.9017  on 6  degrees of freedom
## Residual deviance:  6.8956  on 5  degrees of freedom
## AIC: 28.141
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="poisson-regression.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poisgof</span>(model.cig)</span></code></pre></div>
<pre><code>## $results
## [1] &quot;Goodness-of-fit test for Poisson assumption&quot;
## 
## $chisq
## [1] 6.895581
## 
## $df
## [1] 5
## 
## $p.value
## [1] 0.2285227</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="poisson-regression.html#cb453-1" aria-hidden="true" tabindex="-1"></a>cig<span class="sc">$</span>pred <span class="ot">=</span> model.cig<span class="sc">$</span>fitted<span class="sc">/</span>cig<span class="sc">$</span>person.yrs; cig</span></code></pre></div>
<pre><code>##   cigar.day person.yrs cases        rate        pred
## 1       0.0       1421     0 0.000000000 0.000793326
## 2       5.2        927     0 0.000000000 0.001170787
## 3      11.2        988     2 0.002024291 0.001834458
## 4      15.9        849     2 0.002355713 0.002607843
## 5      20.4       1567     9 0.005743459 0.003652195
## 6      27.4       1409    10 0.007097232 0.006167215
## 7      40.8        556     7 0.012589928 0.016813428</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="poisson-regression.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">idr.display</span>(model.cig)  <span class="co"># interpret?</span></span></code></pre></div>
<pre><code>## 
## Poisson regression predicting cases with offset = log(person.yrs) 
##  
##                        IDR(95%CI)        P(Wald&#39;s test) P(LR-test)
## cigar.day (cont. var.) 1.08 (1.05,1.11)  &lt; 0.001        &lt; 0.001   
##                                                                   
## Log-likelihood = -12.0707
## No. of observations = 7
## AIC value = 28.1413</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="poisson-regression.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - 5 cigar/day</span></span>
<span id="cb457-2"><a href="poisson-regression.html#cb457-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model.cig)[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">5</span>)  <span class="co"># interpret?</span></span></code></pre></div>
<pre><code>## [1] 1.453868</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="poisson-regression.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - 10 cigar/day</span></span>
<span id="cb459-2"><a href="poisson-regression.html#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(model.cig)[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">10</span>)  <span class="co"># interpret?</span></span></code></pre></div>
<pre><code>## [1] 2.113733</code></pre>
</div>
<div id="multiple-poisson-regression-model" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Multiple Poisson regression model</h2>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="poisson-regression.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Again, data from https://stats.idre.ucla.edu/stat/data/poisson_sim.csv</span></span>
<span id="cb461-2"><a href="poisson-regression.html#cb461-2" aria-hidden="true" tabindex="-1"></a>aw <span class="ot">=</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;poisson_sim.csv&quot;</span>))</span>
<span id="cb461-3"><a href="poisson-regression.html#cb461-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(aw)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    200 obs. of  4 variables:
##  $ id        : int  45 108 15 67 153 51 164 133 2 53 ...
##  $ num_awards: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ prog      : int  3 1 3 3 3 1 3 3 3 3 ...
##  $ math      : int  41 41 44 42 40 42 46 40 33 46 ...</code></pre>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="poisson-regression.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aw); <span class="fu">tail</span>(aw)</span></code></pre></div>
<pre><code>##    id num_awards prog math
## 1  45          0    3   41
## 2 108          0    1   41
## 3  15          0    3   44
## 4  67          0    3   42
## 5 153          0    3   40
## 6  51          0    1   42</code></pre>
<pre><code>##      id num_awards prog math
## 195  61          1    2   60
## 196 100          2    2   71
## 197 143          2    3   75
## 198  68          1    2   71
## 199  57          0    2   72
## 200 132          3    2   73</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="poisson-regression.html#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co">#- num_awards: The number of awards earned by students at one high school.</span></span>
<span id="cb466-2"><a href="poisson-regression.html#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="co">#- prog: 1 = General, 2 = Academic, 3 = Vocational</span></span>
<span id="cb466-3"><a href="poisson-regression.html#cb466-3" aria-hidden="true" tabindex="-1"></a><span class="co">#- math: the score on their final exam in math.</span></span>
<span id="cb466-4"><a href="poisson-regression.html#cb466-4" aria-hidden="true" tabindex="-1"></a><span class="co">#- factor prog &amp; save as a new variable prog1</span></span>
<span id="cb466-5"><a href="poisson-regression.html#cb466-5" aria-hidden="true" tabindex="-1"></a>aw<span class="sc">$</span>prog1 <span class="ot">=</span> <span class="fu">factor</span>(aw<span class="sc">$</span>prog, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;General&quot;</span>, <span class="st">&quot;Academic&quot;</span>, <span class="st">&quot;Vocational&quot;</span>))</span>
<span id="cb466-6"><a href="poisson-regression.html#cb466-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(aw)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    200 obs. of  5 variables:
##  $ id        : int  45 108 15 67 153 51 164 133 2 53 ...
##  $ num_awards: int  0 0 0 0 0 0 0 0 0 0 ...
##  $ prog      : int  3 1 3 3 3 1 3 3 3 3 ...
##  $ math      : int  41 41 44 42 40 42 46 40 33 46 ...
##  $ prog1     : Factor w/ 3 levels &quot;General&quot;,&quot;Academic&quot;,..: 3 1 3 3 3 1 3 3 3 3 ...</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="poisson-regression.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aw); <span class="fu">tail</span>(aw)</span></code></pre></div>
<pre><code>##    id num_awards prog math      prog1
## 1  45          0    3   41 Vocational
## 2 108          0    1   41    General
## 3  15          0    3   44 Vocational
## 4  67          0    3   42 Vocational
## 5 153          0    3   40 Vocational
## 6  51          0    1   42    General</code></pre>
<pre><code>##      id num_awards prog math      prog1
## 195  61          1    2   60   Academic
## 196 100          2    2   71   Academic
## 197 143          2    3   75 Vocational
## 198  68          1    2   71   Academic
## 199  57          0    2   72   Academic
## 200 132          3    2   73   Academic</code></pre>
<div id="univariable-1" class="section level3" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> Univariable</h3>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="poisson-regression.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Math</span></span>
<span id="cb471-2"><a href="poisson-regression.html#cb471-2" aria-hidden="true" tabindex="-1"></a>model.aw.u1 <span class="ot">=</span> <span class="fu">glm</span>(num_awards <span class="sc">~</span> math, <span class="at">data =</span> aw, <span class="at">family =</span> poisson)</span>
<span id="cb471-3"><a href="poisson-regression.html#cb471-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.aw.u1) <span class="co"># Math sig.</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = num_awards ~ math, family = poisson, data = aw)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1853  -0.9070  -0.6001   0.3246   2.9529  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -5.333532   0.591261  -9.021   &lt;2e-16 ***
## math         0.086166   0.009679   8.902   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 287.67  on 199  degrees of freedom
## Residual deviance: 204.02  on 198  degrees of freedom
## AIC: 384.08
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="poisson-regression.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Prog</span></span>
<span id="cb473-2"><a href="poisson-regression.html#cb473-2" aria-hidden="true" tabindex="-1"></a>model.aw.u2 <span class="ot">=</span> <span class="fu">glm</span>(num_awards <span class="sc">~</span> prog1, <span class="at">data =</span> aw, <span class="at">family =</span> poisson)</span>
<span id="cb473-3"><a href="poisson-regression.html#cb473-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.aw.u2) <span class="co"># Vocational vs General not sig. -&gt; Combine</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = num_awards ~ prog1, family = poisson, data = aw)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4142  -0.6928  -0.6325   0.0000   3.3913  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -1.6094     0.3333  -4.828 1.38e-06 ***
## prog1Academic     1.6094     0.3473   4.634 3.59e-06 ***
## prog1Vocational   0.1823     0.4410   0.413    0.679    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 287.67  on 199  degrees of freedom
## Residual deviance: 234.46  on 197  degrees of freedom
## AIC: 416.51
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="poisson-regression.html#cb475-1" aria-hidden="true" tabindex="-1"></a>aw<span class="sc">$</span>prog2 <span class="ot">=</span> <span class="fu">recode</span>(aw<span class="sc">$</span>prog1, <span class="st">&quot;c(&#39;General&#39;, &#39;Vocational&#39;) = &#39;General &amp; Vocational&#39;&quot;</span>)</span>
<span id="cb475-2"><a href="poisson-regression.html#cb475-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(aw<span class="sc">$</span>prog2)</span></code></pre></div>
<pre><code>## [1] &quot;Academic&quot;             &quot;General &amp; Vocational&quot;</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="poisson-regression.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Prog2: General &amp; Vocational vs Academic</span></span>
<span id="cb477-2"><a href="poisson-regression.html#cb477-2" aria-hidden="true" tabindex="-1"></a>model.aw.u2a <span class="ot">=</span> <span class="fu">glm</span>(num_awards <span class="sc">~</span> prog2, <span class="at">data =</span> aw, <span class="at">family =</span> poisson)</span>
<span id="cb477-3"><a href="poisson-regression.html#cb477-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.aw.u2a)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = num_awards ~ prog2, family = poisson, data = aw)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4142  -0.6649  -0.6649   0.0000   3.3913  
## 
## Coefficients:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                4.352e-16  9.759e-02   0.000        1    
## prog2General &amp; Vocational -1.509e+00  2.390e-01  -6.314 2.72e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 287.67  on 199  degrees of freedom
## Residual deviance: 234.63  on 198  degrees of freedom
## AIC: 414.69
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="poisson-regression.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">No_Award =</span> aw<span class="sc">$</span>num_awards, aw<span class="sc">$</span>prog2)</span></code></pre></div>
<pre><code>##         
## No_Award Academic General &amp; Vocational
##        0       48                   76
##        1       32                   17
##        2       11                    2
##        3        9                    0
##        4        2                    0
##        5        2                    0
##        6        1                    0</code></pre>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="poisson-regression.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(aw<span class="sc">$</span>num_awards, aw<span class="sc">$</span>prog2, sum)</span></code></pre></div>
<pre><code>##             Academic General &amp; Vocational 
##                  105                   21</code></pre>
</div>
<div id="multivariable-1" class="section level3" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> Multivariable</h3>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="poisson-regression.html#cb483-1" aria-hidden="true" tabindex="-1"></a>model.aw.m1 <span class="ot">=</span> <span class="fu">glm</span>(num_awards <span class="sc">~</span> math <span class="sc">+</span> prog2, <span class="at">data =</span> aw, <span class="at">family =</span> poisson)</span>
<span id="cb483-2"><a href="poisson-regression.html#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.aw.m1)  <span class="co"># both vars sig.</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = num_awards ~ math + prog2, family = poisson, data = aw)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2020  -0.8346  -0.5115   0.2589   2.6793  
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               -4.15050    0.66781  -6.215 5.13e-10 ***
## math                       0.06995    0.01068   6.548 5.83e-11 ***
## prog2General &amp; Vocational -0.89129    0.25662  -3.473 0.000514 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 287.67  on 199  degrees of freedom
## Residual deviance: 190.16  on 197  degrees of freedom
## AIC: 372.22
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="poisson-regression.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">poisgof</span>(model.aw.m1)  <span class="co"># good fit</span></span></code></pre></div>
<pre><code>## $results
## [1] &quot;Goodness-of-fit test for Poisson assumption&quot;
## 
## $chisq
## [1] 190.1611
## 
## $df
## [1] 197
## 
## $p.value
## [1] 0.6235879</code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="poisson-regression.html#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="fu">idr.display</span>(model.aw.m1)  </span></code></pre></div>
<pre><code>## 
## Poisson regression predicting num_awards 
##  
##                                         crude IDR(95%CI)  adj. IDR(95%CI)  
## math (cont. var.)                       1.09 (1.07,1.11)  1.07 (1.05,1.1)  
##                                                                            
## prog2: General &amp; Vocational vs Academic 0.22 (0.14,0.35)  0.41 (0.25,0.68) 
##                                                                            
##                                         P(Wald&#39;s test) P(LR-test)
## math (cont. var.)                       &lt; 0.001        &lt; 0.001   
##                                                                  
## prog2: General &amp; Vocational vs Academic &lt; 0.001        &lt; 0.001   
##                                                                  
## Log-likelihood = -183.108
## No. of observations = 200
## AIC value = 372.216</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="poisson-regression.html#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model.aw.u1, model.aw.u2a, model.aw.m1)</span></code></pre></div>
<pre><code>##              df      AIC
## model.aw.u1   2 384.0762
## model.aw.u2a  2 414.6871
## model.aw.m1   3 372.2160</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="poisson-regression.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - diagnostics</span></span>
<span id="cb491-2"><a href="poisson-regression.html#cb491-2" aria-hidden="true" tabindex="-1"></a>sr <span class="ot">=</span> <span class="fu">rstandard</span>(model.aw.m1)</span>
<span id="cb491-3"><a href="poisson-regression.html#cb491-3" aria-hidden="true" tabindex="-1"></a>sr[<span class="fu">abs</span>(sr) <span class="sc">&gt;</span> <span class="fl">1.96</span>]</span></code></pre></div>
<pre><code>##        54       154       157       164       181       191       199 
##  2.372000  1.996023  2.693894  2.014175  2.342797 -2.013339 -2.261164</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="poisson-regression.html#cb493-1" aria-hidden="true" tabindex="-1"></a>aw<span class="sc">$</span>pred <span class="ot">=</span> model.aw.m1<span class="sc">$</span>fitted</span>
<span id="cb493-2"><a href="poisson-regression.html#cb493-2" aria-hidden="true" tabindex="-1"></a>aw_diag <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">num_of_awards =</span> aw<span class="sc">$</span>num_awards, <span class="at">pred_awards =</span> <span class="fu">round</span>(aw<span class="sc">$</span>pred, <span class="dv">1</span>))</span>
<span id="cb493-3"><a href="poisson-regression.html#cb493-3" aria-hidden="true" tabindex="-1"></a>aw_diag[<span class="fu">names</span>(sr[<span class="fu">abs</span>(sr) <span class="sc">&gt;</span> <span class="fl">1.96</span>]), ] <span class="co"># look at the discrepancies</span></span></code></pre></div>
<pre><code>##     num_of_awards pred_awards
## 54              3         0.5
## 154             2         0.3
## 157             5         1.1
## 164             4         1.2
## 181             6         2.0
## 191             0         2.0
## 199             0         2.4</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="poisson-regression.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - model fit: scaled Pearson chi-square statistic</span></span>
<span id="cb495-2"><a href="poisson-regression.html#cb495-2" aria-hidden="true" tabindex="-1"></a>quasi <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">glm</span>(num_awards <span class="sc">~</span> math <span class="sc">+</span> prog2, <span class="at">data =</span> aw, <span class="at">family =</span> quasipoisson))</span>
<span id="cb495-3"><a href="poisson-regression.html#cb495-3" aria-hidden="true" tabindex="-1"></a>quasi<span class="sc">$</span>dispersion  <span class="co"># dispersion parameter = scaled Pearson chi-square statistic</span></span></code></pre></div>
<pre><code>## [1] 1.08969</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="poisson-regression.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - closer to 1, better.</span></span></code></pre></div>
</div>
<div id="interaction-1" class="section level3" number="10.5.3">
<h3><span class="header-section-number">10.5.3</span> Interaction</h3>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="poisson-regression.html#cb498-1" aria-hidden="true" tabindex="-1"></a>model.aw.i1 <span class="ot">=</span> <span class="fu">glm</span>(num_awards <span class="sc">~</span> math <span class="sc">+</span> prog2 <span class="sc">+</span> math<span class="sc">*</span>prog2, <span class="at">data =</span> aw, <span class="at">family =</span> poisson)</span>
<span id="cb498-2"><a href="poisson-regression.html#cb498-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model.aw.i1)  <span class="co"># interaction term not sig.</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = num_awards ~ math + prog2 + math * prog2, family = poisson, 
##     data = aw)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2295  -0.8162  -0.5377   0.2528   2.6826  
## 
## Coefficients:
##                                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    -4.30286    0.74810  -5.752 8.83e-09 ***
## math                            0.07241    0.01196   6.053 1.42e-09 ***
## prog2General &amp; Vocational      -0.19552    1.50706  -0.130    0.897    
## math:prog2General &amp; Vocational -0.01277    0.02742  -0.466    0.641    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 287.67  on 199  degrees of freedom
## Residual deviance: 189.94  on 196  degrees of freedom
## AIC: 374
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="poisson-regression.html#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model.aw.m1, model.aw.i1)  <span class="co"># increase in AIC, M1 is better</span></span></code></pre></div>
<pre><code>##             df      AIC
## model.aw.m1  3 372.2160
## model.aw.i1  4 373.9965</code></pre>
</div>
<div id="final-model" class="section level3" number="10.5.4">
<h3><span class="header-section-number">10.5.4</span> Final model</h3>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="poisson-regression.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="co"># - Accept model.aw.m1</span></span>
<span id="cb502-2"><a href="poisson-regression.html#cb502-2" aria-hidden="true" tabindex="-1"></a><span class="fu">idr.display</span>(model.aw.m1)</span></code></pre></div>
<pre><code>## 
## Poisson regression predicting num_awards 
##  
##                                         crude IDR(95%CI)  adj. IDR(95%CI)  
## math (cont. var.)                       1.09 (1.07,1.11)  1.07 (1.05,1.1)  
##                                                                            
## prog2: General &amp; Vocational vs Academic 0.22 (0.14,0.35)  0.41 (0.25,0.68) 
##                                                                            
##                                         P(Wald&#39;s test) P(LR-test)
## math (cont. var.)                       &lt; 0.001        &lt; 0.001   
##                                                                  
## prog2: General &amp; Vocational vs Academic &lt; 0.001        &lt; 0.001   
##                                                                  
## Log-likelihood = -183.108
## No. of observations = 200
## AIC value = 372.216</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="poisson-regression.html#cb504-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="fu">coef</span>(model.aw.m1)[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb504-2"><a href="poisson-regression.html#cb504-2" aria-hidden="true" tabindex="-1"></a>b1.ll <span class="ot">=</span> <span class="fu">confint</span>(model.aw.m1)[[<span class="dv">2</span>]]<span class="sc">*</span><span class="dv">10</span></span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="poisson-regression.html#cb506-1" aria-hidden="true" tabindex="-1"></a>b1.ul <span class="ot">=</span> <span class="fu">confint</span>(model.aw.m1)[[<span class="dv">5</span>]]<span class="sc">*</span><span class="dv">10</span></span></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="poisson-regression.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="st">&quot;Math RR&quot;</span> <span class="ot">=</span> b1, <span class="st">&quot;95% LL&quot;</span> <span class="ot">=</span> b1.ll, <span class="st">&quot;95% UL&quot;</span> <span class="ot">=</span> b1.ul))</span></code></pre></div>
<pre><code>##       Math RR  95% LL   95% UL
## [1,] 2.012665 1.63494 2.485884</code></pre>
</div>
</div>
<div id="references-2" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> References</h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>the ln of the denominator/person-years, a(X)<a href="poisson-regression.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="binary-logistic-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="survival-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/drkamarul09_poisson.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["dataanalysis.pdf", "dataanalysis.epub", "dataanalysis.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
